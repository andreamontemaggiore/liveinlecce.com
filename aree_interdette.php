<?php

function contains($point, $polygon)
{
    if($polygon[0] != $polygon[count($polygon)-1])
        $polygon[count($polygon)] = $polygon[0];
    $j = 0;
    $oddNodes = false;
    $x = $point[1];
    $y = $point[0];
    $n = count($polygon);
    for ($i = 0; $i < $n; $i++)
    {
        $j++;
        if ($j == $n)
        {
            $j = 0;
        }
        if ((($polygon[$i][0] < $y) && ($polygon[$j][0] >= $y)) || (($polygon[$j][0] < $y) && ($polygon[$i][0] >=
            $y)))
        {
            if ($polygon[$i][1] + ($y - $polygon[$i][0]) / ($polygon[$j][0] - $polygon[$i][0]) * ($polygon[$j][1] -
                $polygon[$i][1]) < $x)
            {
                $oddNodes = !$oddNodes;
            }
        }
    }
    return $oddNodes;
}

$nomi_zone=array("zona04","zona05","zona14","zona14-2","zona14-3","zona14-4","zona03","zona01","zona02","zona06","zona06-2","zona12","zona17");

$zone= array( "zona04" => array(
                 array(18.172628581523895,40.35693616502255),array(18.172647356987,40.356768564118575),array(18.172687590122223,40.35655906240273) ),	 
				 
"zona05" =>  array(
                 array(18.17209482192993,40.35331834563451),array(18.172063976526257,40.35363925610335),array(18.172194063663483,40.35364845415159),array(18.17223697900772,40.353363314072475),array(18.17209482192993,40.35331834563451) ),

"zona14" =>  array(                  array(18.172770738601685,40.35405418903162),array(18.172848522663116,40.353592243837134),array(18.17289412021637,40.35336944612986),array(18.173561990261078,40.353420546586484)
				  ),
				 
"zona14-2" => array(
				 array(18.1701797246933,40.35809709643191),array(18.170297741889954,40.35786409419608),array(18.17038893699646,40.35760247669097),array(18.170474767684937,40.35736129715416)
                 ),
				 
"zona14-3" =>  array(
				 array(18.172180652618408,40.351642227921616),array(18.17208409309387,40.351450084936886),array(18.172051906585693,40.35134788099855),array(18.17211627960205,40.35125794140469),array(18.172245025634762,40.35120888339385),array(18.172304034233093,40.35091044639235)
                ),
"zona14-4" => array(
				array(18.173001408576965,40.35652329375206),array(18.172772079706192,40.35652022786683),array(18.172774761915207,40.35640270216137),array(18.172963857650757,40.35640576805194),array(18.17296519875526,40.3563648894995),array(18.172750622034073,40.3563618236071),array(18.172749280929565,40.35638839467017),array(18.172538727521896,40.35634547217844),array(18.172529339790344,40.3563638675354),array(18.17265272140503,40.35639452645248),array(18.17266345024109,40.35654679886749),array(18.172684907913208,40.356558040441556),array(18.172855228185654,40.356615270244056),array(18.172869980335236,40.35659891887687),array(18.17285254597664,40.35658256750572),array(18.17285254597664,40.356544754944736),array(18.173002749681473,40.356544754944736),array(18.173001408576965,40.35652329375206) 
                ),
             
"zona03" => array(
				array(18.16963791847229,40.357214136335045),array(18.169729113578796,40.3572958923853),
                array(18.16989004611969,40.35733677037328),array(18.170045614242554,40.35738173613142),
                array(18.170201182365417,40.35738173613142),array(18.17042648792267,40.357365384950114),
                array(18.170592784881592,40.357357209357964),array(18.170812726020813,40.357365384950114),
                array(18.171032667160034,40.35738582392612),array(18.17116677761078,40.357389911720595)
            ),
							
"zona01" =>  array(
                array(18.173768520355225,40.351499142772255),array(18.173808753490448,40.35141124745857),
                array(18.173730969429016,40.35124976507203),array(18.173693418502808,40.35114347265722)
            ),

"zona02" =>  array(
				array(
                18.172859251499172,
                40.357812997106905
                ),
                array(
                  18.173358142375942,
                  40.35803578013213
                ),
                array(
                  18.173468112945557,
                  40.357872269726755
                ),
                array(
                  18.17324012517929,
                  40.35777007552203
                ),
                array(
                  18.173017501831055,
                  40.35766379338479
                ),
                array(
                  18.172859251499172,
                  40.357812997106905
                )
            ),
				
"zona06" => array(
				array(
            18.17261517047882,
            40.35571798310823
          ),
          array(
            18.172682225704193,
            40.355225389877056
          ),
          array(
            18.172754645347595,
            40.35466942970838
          ),
          array(
            18.172760009765625,
            40.354610154272926
          ),
          array(
            18.172727823257446,
            40.354554966751685
          ),
          array(
            18.17272514104843,
            40.354262676534276
          ),
          array(
            18.172727823257446,
            40.35420135674748
          ),
          array(
            18.1727734208107,
            40.35405623302987
          ),
          array(
            18.173159658908844,
            40.354101200975755
          ),
          array(
            18.17312479019165,
            40.35429946837959
          ),
          array(
            18.173081874847412,
            40.354381227964
          ),
          array(
            18.17304700613022,
            40.354389403917
          ),
          array(
            18.172923624515533,
            40.354557010734766
          ),
          array(
            18.172738552093502,
            40.35456518666644
          )
        ),
				
"zona06-2" => array(
				array(
              18.172679543495178,
              40.35524378553958
            ),
            array(
              18.172840476036072,
              40.35526013723538
            ),
            array(
              18.17291021347046,
              40.35457336259713
            ),
            array(
              18.172765374183655,
              40.3545774505621
            ),
            array(
              18.172679543495178,
              40.35524378553958
            )
            ),
				
"zona12" => array( array(18.16898077726364,40.349665581916305),array(18.169168531894684,40.349512271894106),
                array(18.169002234935757,40.34939166776508),array(18.168814480304718,40.34955724287007),
                array(18.16898077726364,40.349665581916305)
                 ),
				
"zona17" => array( 
				    array(
              18.171700537204742,
              40.35314664768646
            ),
            array(
              18.171705901622772,
              40.35322023257488
            ),
            array(
              18.171925842761993,
              40.353222276598416
            ),
            array(
              18.172070682048798,
              40.35330608150986
            ),
            array(
              18.172255754470825,
              40.35335309397556
            ),
            array(
              18.172666132450104,
              40.35338784229871
            ),
            array(
              18.172891438007355,
              40.35340828248043
            ),
            array(
              18.1728994846344,
              40.35336535809166
            ),
            array(
              18.173025548458096,
              40.353371490148874
            ),
            array(
              18.173055052757263,
              40.35303013811559
            ),
            array(
              18.17305237054825,
              40.35287479170797
            ),
            array(
              18.173048347234726,
              40.35287581372499
            ),
            array(
              18.17297726869583,
              40.35287479170797
            ),
            array(
              18.17297726869583,
              40.35272966513544
            ),
            array(
              18.172848522663116,
              40.35272966513544
            ),
            array(
              18.1728458404541,
              40.35286457153703
            ),
            array(
              18.172628581523895,
              40.35287274767392
            ),
            array(
              18.1725212931633,
              40.35284617522545
            ),
            array(
              18.172446191310883,
              40.35295450898817
            ),
            array(
              18.171797096729275,
              40.352952464956516
            ),
            array(
              18.171700537204742,
              40.35314664768646
            )
            )
				

				);
                
$lat=$_POST['lat']; 
$lon=$_POST['lon']; 

$point = array($lon,$lat);  
//$point = array(18.172631,40.353219); 

$trovato=false;	
for($i=0;$i<sizeof($nomi_zone);$i++){
		$polygon = $zone[$nomi_zone[$i]];
		$trovato=contains($point,$polygon);
		if($trovato){
        			echo(' [{"Punto":"La via indicata si trova all\'interno di una zona interdetta al traffico"] ');
					break;
		}
}			
	
if($trovato==false){
		echo(' [{"Punto":"La via indicata non si trova all\'interno di una zona interdetta al traffico"] ');
}

